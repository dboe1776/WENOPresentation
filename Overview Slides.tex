\documentclass[9pt]{beamer}

\usetheme{metropolis}
\usepackage{appendixnumberbeamer}

\usepackage{booktabs}
\usepackage[scale=2]{ccicons}
\usepackage{amsmath}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{subfigure}
\graphicspath{{Graphics/}}


\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}

\title{High Order, Non-linear Finite Difference Schemes}
\subtitle{Thesis Research - Overview}

%\subtitle{Validation}
\date{\today}
\author{Daniel Boe}
\institute{South Dakota School of Mines and Technology}

\begin{document}

\maketitle

\begin{frame}{Overview}
  \begin{itemize}
  \item Introduction - discussion of the conservation law its applications
  \item Overview of finite difference methods
  \item The WENO scheme
  \item A positivity preserving WENO scheme 
  \item Numerical Examples
  \item Conclusion
  \end{itemize}
  \end{frame}

\begin{frame}{Conservation Law}
  The conservation law is a fundamental principle that forms the basis for modeling numerous physical processes.  In the simplest terms, this law enforces the idea that, in a closed system, the overall quantity of some property can only change by adding or removing this property.  Mathematically, a conservation law is expressed as
  
  \begin{equation}
    \frac{\partial u(x,t)}{\partial t} + \frac{\partial}{\partial x}[f(u(x,t))]=0\label{eq:Conservation Law}
  \end{equation}
  
  where 
  \begin{itemize}
    \item $u(x,t)$ is a function describing the distribution of some physical quantity 
    \item $f$ is a function giving the flux of the conserved quantity.
  \end{itemize}

\end{frame}

\begin{frame}{Euler Equations}
  In the context of gas dynamics, the conservation of mass, momentum, and energy form a set of three coupled equations known as the Euler equations.
  \begin{align}
    \frac{\partial \rho}{\partial t}+\frac{\partial}{\partial x}[\rho v] &=0\label{eq:MassBalance}\\
    \frac{\partial}{\partial t}[\rho v]+\frac{\partial}{\partial x}[\rho v^2+p]&=0\label{eq:MomentaBalance}\\
    \frac{\partial}{\partial t}[\rho(e+\tfrac{v^2}{2})]+\frac{\partial}{\partial x}[(\rho e+\tfrac{\rho v^2}{2} +p)v]&=0\label{eq:EnergyBalance}
    \end{align} 
  \begin{itemize}
    \item Ideal Gas Law gives $e\rho(\gamma -1)=p$
    \begin{itemize}
      \item[o] $e$ is specific internal energy.  
      \item[o] $\gamma$ specific heat ratio $\frac{c_p}{c_v}$
    \end{itemize}
    \item $\textbf{u}=[\rho,\rho v,\rho(e+\tfrac{v^2}{2})]^T$
    \begin{itemize}
      \item[o] vector of \textit{conserved} variables - specific density, specific momentum, and specific total energy. 
    \end{itemize}
    \item $\textbf{u}_p=[\rho,v, p]^T$
    \begin{itemize}
      \item[o] vector of \textit{primitive} variables - density, velocity, and pressure
    \end{itemize}
    \item $\textbf{f} = [\rho v, \rho v^2 + p, (\rho(e+\tfrac{\rho v^2}{2})+p)v]^T$
    \begin{itemize}
      \item[o] vector of fluxes
    \end{itemize}
  \end{itemize}
\end{frame}


\begin{frame}{Two Fluid System}
  The Euler equations can be extended to a two-fluid system by adding two equations.
  \begin{align}
    \frac{\partial \Gamma_1 }{\partial t} + v\frac{\partial \Gamma_1}{\partial x}&=0\label{eq: Order Parameter One}\\
    \frac{\partial \Gamma_2 }{\partial t} + v\frac{\partial \Gamma_2}{\partial x}&=0\label{eq: Order Parameter Two}
  \end{align}

  \begin{itemize}
    \item Stiffened Gas Equation of State: $p = e\rho(\gamma - 1) -\gamma \Pi$
    \begin{itemize}
      \item[o] Provides a means of modeling state for both liquid and gas 
      \item[o] $\Pi$ is empirical parameter (0 for ideal gasses)  
    \end{itemize}
    \item $\Gamma_1 = \frac{1}{\gamma -1}$
    \item $\Gamma_2 = \frac{\gamma \Pi}{\gamma -1}$
  \end{itemize}

\end{frame}


\begin{frame}{Finite Difference Schemes}
\textbf{Why Finite Difference Schemes?}
\begin{itemize}
\item Able to capture shock discontinuities prevalent in CFD
\item Well suited for multi-scale phenomena associated with multi-phase/multi-fluid dynamics.
\item Unmatched simplicity and efficiency
\item Less computationally expensive than Finite Volume Methods
\begin{itemize}
\item[--] Particularly for high order or two/three dimensional problems \cite{FVFDComparison}
\end{itemize}
\end{itemize}
\textbf{Why High Order Schemes?}
\begin{itemize}
\item High order schemes allow for greater accuracy per CPU cost
\begin{itemize}
\item[--] Enhances ability to solve multi-dimensional problems
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Review of Finite Difference Methods}
  To facilitate the development of the numerical scheme, consider the discrete 1D conservation law over a domain $[x_{min},x_{max}] \times [0,t_{max}]$.
  \begin{equation}
    \frac{\partial}{\partial t}[u_i^n] + \frac{\partial}{\partial x}[f(u_i^n)] = 0
  \end{equation}
  where 
  \begin{itemize}
    \item $u_i = u(x_i)$ is the conserved variable evaluated at the gridpoint $x_i$
    \begin{itemize}
      \item[o]  $i \in \{0,1,2 \dots N-1\}$ with $N$ being the total number of cells
      \item[o] $h = \frac{x_{max} - x_{min}}{N}$ is the step size in-between adjacent cells
    \end{itemize}
    \item $u_i^n = u_i(x_i,t_n)$ is the conserved variable evaluated at the $n^{th}$ time step.
    \begin{itemize}
      \item[o] $\tau$ denotes temporal time step 
    \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Finite Difference Schemes}
  The Taylor Series expansion $u(x)$ centered about $x_i$ evaluated at $x=x_i + jh$ is:
  \begin{equation}
    u(x_i+jh)=u(x_i)+(jh)\frac{d u}{dx}\bigg|_{x_i}+\frac{(jh)^2}{2!}\frac{d^2u}{dx^2}\bigg|_{x_i} + \frac{(jh)^3}{3!}\frac{d^3u}{dx^3}\bigg|_{x_i} + \mathcal{O}(h^4)
  \end{equation}
  taking $j=1$, we have 
  \begin{equation}
    u(x_i+h)=u(x_i)+(h)\frac{d u}{dx}\bigg|_{x_i}+ \frac{1}{2!}\frac{d^2u}{dx^2}\bigg|_{x_i}+ \mathcal{O}(h^3)
  \end{equation}
  Truncating the higher order terms and solving for the derivative gives:
  \begin{equation}
    \frac{d u}{dx}\bigg|_{x_i} \approx \frac{u(x_i+h) - u(x_i)}{h} = \frac{u_{i+1} - u_i}{h}
  \end{equation}
  which is a first order, \textit{forward} finite difference approximation.
  \begin{itemize}
    \item It is a forward-biased approximation because we utilize a point ($x_{i+1}$) that falls after or downwind of $x_i$ on the grid.
    \item Taking $j=-1$ would give a backwards finite difference formula.
    \item Subtracting the backwards scheme from the forward scheme would cancel the second derivative term to give a second order approximation.
  \end{itemize}
\end{frame}


\begin{frame}{Higher Order Schemes
  }
  High order finite difference approximations can be obtained by evaluating the Taylor expansion at multiple points surrounding $x_i$ and combining each approximation such that the $2^{nd}, 3^{rd}, 4^{th} \dots $ order terms cancel.  

    \begin{figure}[H]
      \centering
      \includegraphics[scale=0.45]{AdvectionHighOrderComparison.eps}\caption{Comparison of First and Third Order solutions for advection equation with smooth initial condition}
        \label{fig:First/HighOrderComparison}
      \end{figure}

\end{frame}

\begin{frame}{Discontinuous Solutions}
  \begin{itemize}
    \item High order methods work great provided the solution is continuous. 
    \item For discontinuous solutions, high order methods suffer from spurious oscillations that do not diminish with grid refinement.
  \end{itemize}

  
  \begin{figure}[H]
    \centering
    \includegraphics[scale=0.45]{AdvectionHighOrderComparison_pulse.eps}\caption{Comparison of First and Third Order solutions for advection equation with discontinuous initial condition}
      \label{fig:First/HighOrderComparison_pulse}
    \end{figure}
\end{frame}

\begin{frame}{Conservation Laws with Discontinuous Data}
  \textbf{Why Non-Linear Schemes?}
  \begin{itemize}
  \item High order Finite Difference schemes suffer from spurious oscillations near discontinuities
  \item Non-linear methods attenuate oscillations by utilizing a feedback loop to adjust the solution scheme near discontinuities
  \begin{itemize}
  \item[--] High order solution is retained in smooth regions 
  \item[--] First order, non-oscillatory solution is obtained in discontinuous regions
  \end{itemize}
  \end{itemize}
\end{frame}

\begin{frame}{Motivation - Non-Linear Schemes}
  \textbf{WENO Method}  
  \newline Assume the spatial derivative term can be written exactly as the difference of some ``numerical flux function" evaluated at the cell boundaries.
  \begin{equation}
    \frac{\partial}{\partial x}[f(u_i)] = \frac{\bar{f}_{i+1 /2} - \bar{f}_{i-1/2}}{h}
  \end{equation}
  where
  \begin{equation}
    f(u_i)=\frac{1}{h}\int_{x-h/2}^{x+h/2} \bar{f}(\xi)d\xi
  \end{equation}
  \begin{itemize}
  \item Thus, the goal of the WENO scheme is to develop high order, non-oscillatory approximations for the numerical flux function $\hat{f}_{i\pm1/2}$
  \item The numerical flux function can be computed from the known flux $f(u_i)$
  \item Technically, WENO is not, in itself, a finite difference scheme; rather it is a method of flux reconstruction. \cite{Jiang96,Henrick05}
  \end{itemize}
  \end{frame}


\begin{frame}{WENO Framework}
  For an arbitrary function $u(x_i)$, we can form an $r^{th}$ order, polynomial representation of $u(x_{i+1/2})$ as:
  \begin{equation}
    u(x_i+\tfrac{1}{2}h) \approx P_{r,k_s,i+\frac{1}{2}}= \sum_{q=0}^{q=r-1}a_{r,k_s,q}u_{i-k_s+q}\label{eq:PolynomialReconstruction}
  \end{equation}
  where $a_{r,k_s,q}$ are tabulated constants for a given order ($r$), stencil ($k_s$), and stencil cell ($q$).
  \begin{figure}[H]
    \centering
    \includegraphics[scale=0.165]{StencilReconstruct.png}\caption{Illustration of candidate stencils for forming $P_{r,k_s,i+1/2}$}
      \label{fig: Stencil Graphic}
  \end{figure}
\end{frame}

\begin{frame}{WENO Framework Continued}
  By properly combining the polynomials associated with each candidate stencil, we can construct a $2r-1$ order approximation for $u(x_{i+1/2})$
  \begin{equation}
    P^{*}_{r,i+\frac{1}{2}} = \sum_{k_s=0}^{k_s=r-1}b_{r,k_s}P_{r,k_s,i+\frac{1}{2}}\label{eq: Optimal Reconstruction Definition}
  \end{equation}
  Here, $b_{r,k_s}$ are tabulated weights assigned to the local, $r^{th}$ order polynomial associated with sub-stencil $k_s$.
  
  \begin{itemize}
    \item The goal of WENO is to modify the above approximation such that:
    \begin{enumerate}
      \item If sub-stencil $k_s$ contains a discontinuity, the weight $b_{r,k_s} \longrightarrow 0$ effectively negating the impacts of the discontinuity.
      \item If no sub-stencils contain discontinuities, the above $2r-1$ order approximation is recovered.
    \end{enumerate}
  \end{itemize}
\end{frame}

\begin{frame}{WENO Framework Continued}
  The WENO reconstruction of $u(x_{i+1/2})$ takes the form:
  \begin{equation}
    P^{WENO}_{r,i+\frac{1}{2}}=\sum_{k_s=0}^{k_s=r-1}\omega_{r,k_s,i+\frac{1}{2}}P_{r,k_s,i+\frac{1}{2}}\label{eq:WenoEquation}
  \end{equation}
  where 
  \begin{align}
    \omega_{r,k_s}&=\frac{\alpha_{r,k_s}}{\sum_{j=0}^R\alpha_{r,j}}\\
    \alpha_{r,k_s}&=\frac{b_{r,k_s}}{(\beta_{r,k_s,i} +10^{-40})^r}
  \end{align}
  define the WENO weights in terms of the linear, ``optimal weights'' ($b_{r,k_s}$) and a non-linear smoothness indicator $\beta_{r,k_s,i}$ which is defined as the sum of the $L^2$ norms of all derivatives of the original interpolating polynomial associated with the $k_s$ sub-stencil. 
  \begin{equation}
    \beta_{r,k_s,i} = \sum_{l=0}^{r-1}h^{2m-1}\int_{-\frac{1}{2}h}^{\frac{1}{2}h}\bigg[\frac{d^m}{d\xi}P_{r,k_s,i+1/2}(\xi)\bigg]^2d(\xi-x_i)\label{eq:OptimalCoefficients}
  \end{equation}
\end{frame}

\begin{frame}{WENO Framework Summary}
  The WENO process can be thought of as an operator, $L$, that takes a function $w(x_i)$ defined on a grid $x_i \in \{x_0, x_1 \dots x_{N-1}
  \}$ and computes a $2r-1$ order polynomial approximation of $w$ at the intercell points $x_{i+1/2}$.
  $$L(w_{i}) = \hat{w}_{{i+\frac{1}{2}}}\approx w_{{i+\frac{1}{2}}}$$
  The basic steps for a $2r-1$ order approximation are:
  \begin{enumerate}
    \item Calculate the $r$ local polynomials: $P_{r,k_s,i+\frac{1}{2}}= \sum_{q=0}^{q=r-1}a_{r,k_s,q}w_{i-k_s+q}$
    \item For each $P_{r,k_s,i+\frac{1}{2}}$, calculate the WENO smoothness indicators $\beta_{r,k_s,i}$.
    \begin{itemize}
      \item[o] These calculations are tabulated in the literature
    \end{itemize}
    \item Assemble the WENO weights, $\omega_{r,k_s}$, from the constant optimal weights $b_{r,k_s}$ and the non-linear weights $\beta_{r,k_s,i}$. 
    \item Calculate the WENO polynomial: $\hat{w}_{i+1/2}=\sum_{k_s=0}^{k_s=r-1}\omega_{r,k_s,i+\frac{1}{2}}P_{r,k_s,i+\frac{1}{2}}$
  \end{enumerate}
\end{frame}

\begin{frame}{WENO Implementation}
  The WENO scheme provides a method for forming non-oscillatory approximations to the numerical flux function $\bar{f}_{i\pm 1/2}$. 
\begin{itemize}
  \item In general, the WENO reconstruction of the original flux $f$ gives this high order approximation.
  $$\bar{f}_{i+1/2} \approx \hat{f}_{i+1/2} = L(f(u_i))$$
  \item  Performing the reconstruction on the known fluxes supplies the high order derivative approximation as:
  $$\frac{\partial}{\partial x}[f(u_i)] \approx \frac{\hat{f}_{i+1 /2} - \hat{f}_{i-1/2}}{h}$$
  \item Alternately, the WENO reconstruction can be performed \textit{directly} on the primitive variables (or conservative variable in the scalar case).
  $$\bar{f}_{i+1/2} \approx f(\hat{u}_{i+1/2}) = f(L(u_i))$$
  \begin{itemize}
    \item[o] With this scheme, the spatial derivative is calculated with tabulated constants ($d_j$) as\cite{Shahbazi}:
    $$	h\frac{\partial f}{\partial x}\bigg|_{x_i}\approx \sum_{j=1}^{j=\text{ceil}(\tfrac{r}{2})}d_j(f(\hat{u}_{i+j-1/2})-f(\hat{u}_{i-j-1/2}))$$
  \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{Non-linear Schemes are awesome}
  \begin{figure}[H]
    \centering
    \includegraphics[scale=0.25]{DensitySolutions.eps}\caption{Comparison of linear and non-linear schemes for shock-entropy wave interaction problem}
      \label{fig:ShockEntropy}
    \end{figure}
\end{frame}

\begin{frame}{Non-linear schemes also have issues}
  \begin{itemize}
    \item The WENO scheme is designed to provide ``essentially" non-oscillatory behavior, meaning that some relatively insignificant, small oscillations may be remain.
    \item In many cases, these small oscillations have no impact on the overall solution; however for certain scenarios, they can pose problems.
    \item For the Euler system, slight oscillations can result in negative density and/or pressure values which imply a complex speed of sound
    \begin{itemize}
      \item[o] Unphysical results lead to simulation crashing.
      \item[o] This issue is readily observed for problems that involve high Mach shock waves with complex interactions
    \end{itemize}  
  \end{itemize}
  \textbf{To remedy this, a positivity preserving scheme needs to be developed.}
\end{frame}

\begin{frame}{Parameterized Flux Limiting Positivity Preservation Scheme}
  $$u_i^{n+1}=u_i^n-\frac{\tau}{h}\{H^{RK}_{i,+} - H^{RK}_{i,-}\}$$
\end{frame}

\begin{frame}{Positivity is good for Burgers equation}
  
\end{frame}


\begin{frame}{Positivity is even better for Euler}
  show several plots - demos to illustrate this.
\end{frame}



\begin{frame}{Research Goals}
  The overall goals of this project are as follows:
  \begin{itemize}
  \item Implement Dr. Shahbazi's proposed primitive variable based WENO scheme \cite{Shahbazi} for $9^{\text{th}}$ order and higher
  \item Enforce positivity preservation for density and pressure
  \begin{itemize}
  \item[--] Generalize methods of Xiong et al \cite{Positivity2014} to primitive variable based WENO scheme.
  \end{itemize}
  \item Extend to multi-phase model
  \begin{itemize}
  \item[--] Four equation model of Saurel et al \cite{FourEquationModel}
  \item[--] Five equation model \cite{FiveEquationModel}
  \end{itemize}
  \item Extend to 2D
  \end{itemize}
\end{frame}

\section{High Level Description of Method}

\begin{frame}{Euler Equations of Gas Dynamics}
To demonstrate the mechanisms of a non-linear scheme, consider the three-dimensional Euler Equations of gas dynamics:
\begin{align}
\frac{\partial \rho}{\partial t}+\frac{\partial}{\partial x_j}[\rho v_j] &=0\label{eq:MassBalance}\\
\frac{\partial}{\partial t}[\rho v_i]+\frac{\partial}{\partial x_j}[\rho v_iv_j+p\delta_{ij}]&=0\label{eq:MomentaBalance}\\
\frac{\partial}{\partial t}[\rho(e+\tfrac{v_jv_j}{2})]+\frac{\partial}{\partial x_i}[(\rho e+\tfrac{\rho v_jv_j}{2} +p)v_i]&=0\label{eq:EnergyBalance}
\end{align}

where $e$ is the specific internal energy. In addition to these three equations, an additional property relation (e.g. Ideal Gas Law) is utilized in order to obtain a solvable system. 
\end{frame}

% Add gamma for air.. Euler Equations for liquid and gasses

\begin{frame}{Numerical Interpretation of Euler System}
Each one of the Euler Equations is just a conservation law of the form:
\begin{equation}
	\frac{\partial u}{\partial t}=-\frac{\partial}{\partial x}[f(u)]\label{eq:ConservationLaw}
\end{equation}
 enforced upon mass, momentum, and energy, respectively. We define a vector of conserved variables as: $$\textbf{u}=[\rho,\rho v,\rho(e+\tfrac{v^2}{2})]^T$$ and the flux of the conserved variables as:
\begin{equation}
	\textbf{f} = [\rho v, \rho v^2 + p, (\rho e +\frac{\rho v^2}{2}+p)v]^T\label{eq: Flux Functions}
\end{equation}

Finally, we can define the primitive variables as the quantities from which the conservation variables are constructed

\begin{equation}
\textbf{u}_p=[\rho,v,p]^T
\end{equation}

\end{frame}




\begin{frame}{Traditional Flux Based Approach}
Traditionally, the WENO reconstruction process has been performed on the flux functions \eqref{eq: Flux Functions}.  This allows for the right hand side of a conservation law to be expressed exactly as:
\begin{equation}
\frac{\partial}{\partial	x}[f(u)]\bigg|_{x_i}=\frac{h(u_{i+1/2}) - h(u_{i-1/2})}{\Delta x} \label{eq: Traditional Derivative}
\end{equation}
where $h$ is defined to be some function that gives $f(u(x))$ when averaged over the interval $x\in[x-\frac{1}{2}\Delta x, x+\frac{1}{2}\Delta x]$, that is:
\begin{equation}
f(u(x))=\frac{1}{\Delta x} \int_{x-\frac{1}{2}\Delta x}^{x+\frac{1}{2}\Delta x}h(u(\xi))d\xi
\end{equation}
Since, $f(u(x_i))$ is known, the values $h(u_{i\pm1/2})\approx P_{WENO, 2r-1}(x_{i+\frac{1}{2}})$ can be approximated using the WENO scheme to yield a high order approximation to the spatial derivative term in the conservation law.  However, as shown by Shahbazi \cite{Shahbazi}, this approach can fail to preserve the non-oscillatory property for certain multi-fluid flow problems.  To combat this, a new method based upon the WENO reconstruction of primitive variables was proposed.
\end{frame}


\begin{frame}{Primitive Variable Reconstruction Approach}
The key difference between the traditional WENO method and the scheme proposed by Shahbazi \cite{Shahbazi} lies in how the spatial derivatives are calculated.  In the traditional approach, the derivatives are calculated using the WENO reconstruction directly on the flux functions.   In the new method, the derivatives are approximated to order $2r$ by performing the WENO reconstruction on the primitive variables and then forming the flux functions directly from these approximated values.  Here, the derivative term is calculated as:     

\begin{equation}
h\frac{\partial f}{\partial x}\bigg|_{x_i}\approx (\hat{f}_{i+1/2}-\hat{f}_{i-1/2}) = \sum_{q=0}^{q=r}d_q(f^{WENO}_{i+q-1/2}-f^{WENO}_{i-q-1/2})
\label{eq: derivative definition}
\end{equation}  

With Equation \ref{eq: derivative definition} giving a high order approximation for the right hand side of each governing equation, a High-order Runge-Kutte method can be utilized to integrate in time. 

\end{frame}


\begin{frame}[standout]
  Thank You
\end{frame}

\appendix

\begin{frame}[allowframebreaks]{References}

  \bibliography{references.bib}
  \bibliographystyle{abbrv}

\end{frame}


\end{document}